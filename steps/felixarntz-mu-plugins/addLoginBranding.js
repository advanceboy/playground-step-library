customSteps.addLoginBranding = function() {
    var steps = [
    {
        "step": "mkdir",
        "path": "wordpress/wp-content/mu-plugins/felixarntz-mu-plugins",
        "dedup": true
    },
    {
        "step": "unzip",
        "zipFile": {
            "resource": "url",
            "url": "https://raw.githubusercontent.com/akirk/playground-step-library/main/felixarntz-mu-plugins-shared.zip"
        },
        "extractToPath": "/wordpress/wp-content/mu-plugins",
        "dedup": true
    },
    {
        "step": "writeFile",
        "path": "wordpress/wp-content/mu-plugins/felixarntz-mu-plugins/add-login-branding.php",
        "data": "<?php\n/**\n * Plugin Name: Add Login Branding\n * Plugin URI: https://github.com/felixarntz/felixarntz-mu-plugins\n * Description: Adds site specific branding to the login page.\n * Author: Felix Arntz\n * Author URI: https://felix-arntz.me\n * License: GPLv2 or later\n * License URI: https://www.gnu.org/licenses/old-licenses/gpl-2.0.html\n * Text Domain: felixarntz-mu-plugins\n *\n * @package felixarntz-mu-plugins\n */\n\nnamespace Felix_Arntz\\MU_Plugins;\n\nif ( ! defined( 'ABSPATH' ) ) {\n\texit; // Exit if accessed directly.\n}\n\nrequire_once __DIR__ . '/shared/loader.php';\n\n// Displays custom branding as configured, or using the site icon if set.\nadd_action(\n\t'login_head',\n\tstatic function () {\n\t\t$config = Shared\\Config::instance();\n\n\t\t$highlight_color       = $config->get( 'login_highlight_color', '' );\n\t\t$highlight_color_hover = $config->get( 'login_highlight_color_hover', '' );\n\t\t$header_image_url      = $config->get( 'login_header_image_url', '' );\n\t\t$header_image_size     = $config->get( 'login_header_image_size', '' );\n\n\t\t// Use site icon if no header image is set.\n\t\tif ( ! $header_image_url || ! $header_image_size ) {\n\t\t\t$header_image_url  = get_site_icon_url( 192 );\n\t\t\t$header_image_size = 192;\n\t\t}\n\n\t\tif ( $highlight_color && $highlight_color_hover ) {\n\t\t\t$highlight_color_shadow = Shared\\Color_Utils::to_css_string(\n\t\t\t\tShared\\Color_Utils::set_rgb_opacity(\n\t\t\t\t\tShared\\Color_Utils::hex_to_rgb( $highlight_color ),\n\t\t\t\t\t80\n\t\t\t\t)\n\t\t\t);\n\n\t\t\t?>\n\t\t\t<style type=\"text/css\">\n\t\t\t\ta {\n\t\t\t\t\tcolor: <?php echo esc_attr( $highlight_color ); ?>;\n\t\t\t\t}\n\n\t\t\t\ta:hover,\n\t\t\t\ta:active {\n\t\t\t\t\tcolor: <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t}\n\n\t\t\t\t.login #nav a:hover,\n\t\t\t\t.login #backtoblog a:hover,\n\t\t\t\t.login h1 a:hover {\n\t\t\t\t\tcolor: <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t}\n\n\t\t\t\tinput[type=\"text\"]:focus,\n\t\t\t\tinput[type=\"password\"]:focus,\n\t\t\t\tinput[type=\"color\"]:focus,\n\t\t\t\tinput[type=\"date\"]:focus,\n\t\t\t\tinput[type=\"datetime\"]:focus,\n\t\t\t\tinput[type=\"datetime-local\"]:focus,\n\t\t\t\tinput[type=\"email\"]:focus,\n\t\t\t\tinput[type=\"month\"]:focus,\n\t\t\t\tinput[type=\"number\"]:focus,\n\t\t\t\tinput[type=\"password\"]:focus,\n\t\t\t\tinput[type=\"search\"]:focus,\n\t\t\t\tinput[type=\"tel\"]:focus,\n\t\t\t\tinput[type=\"text\"]:focus,\n\t\t\t\tinput[type=\"time\"]:focus,\n\t\t\t\tinput[type=\"url\"]:focus,\n\t\t\t\tinput[type=\"week\"]:focus,\n\t\t\t\tinput[type=\"checkbox\"]:focus,\n\t\t\t\tinput[type=\"radio\"]:focus,\n\t\t\t\tselect:focus,\n\t\t\t\ttextarea:focus {\n\t\t\t\t\tborder-color: <?php echo esc_attr( $highlight_color ); ?>;\n\t\t\t\t\t-webkit-box-shadow: 0 0 2px <?php echo esc_attr( $highlight_color_shadow ); ?>;\n\t\t\t\t\tbox-shadow: 0 0 2px <?php echo esc_attr( $highlight_color_shadow ); ?>;\n\t\t\t\t}\n\n\t\t\t\t.wp-core-ui .button-primary {\n\t\t\t\t\tbackground: <?php echo esc_attr( $highlight_color ); ?>;\n\t\t\t\t\tborder-color: <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t\t-webkit-box-shadow: 0 1px 0 <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t\tbox-shadow: 0 1px 0 <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t\tcolor: #fff;\n\t\t\t\t\ttext-shadow: 0 -1px 1px <?php echo esc_attr( $highlight_color_hover ); ?>,\n\t\t\t\t\t\t1px 0 1px <?php echo esc_attr( $highlight_color_hover ); ?>,\n\t\t\t\t\t\t0 1px 1px <?php echo esc_attr( $highlight_color_hover ); ?>,\n\t\t\t\t\t\t-1px 0 1px <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t}\n\n\t\t\t\t.wp-core-ui .button-primary.hover,\n\t\t\t\t.wp-core-ui .button-primary:hover,\n\t\t\t\t.wp-core-ui .button-primary.focus,\n\t\t\t\t.wp-core-ui .button-primary:focus {\n\t\t\t\t\tbackground: <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t\tborder-color: <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t\tcolor: #fff;\n\t\t\t\t}\n\n\t\t\t\t.wp-core-ui .button-primary.focus,\n\t\t\t\t.wp-core-ui .button-primary:focus {\n\t\t\t\t\t-webkit-box-shadow: 0 1px 0 <?php echo esc_attr( $highlight_color_hover ); ?>,\n\t\t\t\t\t\t0 0 2px 1px <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t\tbox-shadow: 0 1px 0 <?php echo esc_attr( $highlight_color_hover ); ?>,\n\t\t\t\t\t\t0 0 2px 1px <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t}\n\n\t\t\t\t.wp-core-ui .button-primary.active,\n\t\t\t\t.wp-core-ui .button-primary.active:hover,\n\t\t\t\t.wp-core-ui .button-primary.active:focus,\n\t\t\t\t.wp-core-ui .button-primary:active {\n\t\t\t\t\tbackground: <?php echo esc_attr( $highlight_color ); ?>;\n\t\t\t\t\tborder-color: <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t\t-webkit-box-shadow: inset 0 2px 0 <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t\tbox-shadow: inset 0 2px 0 <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t}\n\n\t\t\t\t.wp-core-ui .button-primary[disabled],\n\t\t\t\t.wp-core-ui .button-primary:disabled,\n\t\t\t\t.wp-core-ui .button-primary-disabled,\n\t\t\t\t.wp-core-ui .button-primary.disabled {\n\t\t\t\t\topacity: 0.8;\n\t\t\t\t\tcolor: #ffffff !important;\n\t\t\t\t\tbackground: <?php echo esc_attr( $highlight_color ); ?> !important;\n\t\t\t\t\tborder-color: <?php echo esc_attr( $highlight_color_hover ); ?> !important;\n\t\t\t\t}\n\n\t\t\t\t.wp-core-ui .button.button-primary.button-hero {\n\t\t\t\t\t-webkit-box-shadow: 0 2px 0 <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t\tbox-shadow: 0 2px 0 <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t}\n\n\t\t\t\t.wp-core-ui .button.button-primary.button-hero.active,\n\t\t\t\t.wp-core-ui .button.button-primary.button-hero.active:hover,\n\t\t\t\t.wp-core-ui .button.button-primary.button-hero.active:focus,\n\t\t\t\t.wp-core-ui .button.button-primary.button-hero:active {\n\t\t\t\t\t-webkit-box-shadow: inset 0 3px 0 <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t\tbox-shadow: inset 0 3px 0 <?php echo esc_attr( $highlight_color_hover ); ?>;\n\t\t\t\t}\n\t\t\t</style>\n\t\t\t<?php\n\t\t}\n\n\t\t// If header image is available, display it instead of the WordPress logo and replace the link accordingly.\n\t\tif ( $header_image_url && $header_image_size ) {\n\t\t\tif ( is_string( $header_image_size ) && str_contains( $header_image_size, 'x' ) ) {\n\t\t\t\t$parts               = explode( 'x', $header_image_size );\n\t\t\t\t$header_image_width  = (int) $parts[0];\n\t\t\t\t$header_image_height = (int) $parts[1];\n\t\t\t} else {\n\t\t\t\t$header_image_width  = (int) $header_image_size;\n\t\t\t\t$header_image_height = $header_image_width;\n\t\t\t}\n\n\t\t\t?>\n\t\t\t<style type=\"text/css\">\n\t\t\t\t.login h1 a {\n\t\t\t\t\tbackground-image: url('<?php echo esc_attr( $header_image_url ); ?>');\n\t\t\t\t\tbackground-size: <?php echo esc_attr( $header_image_width ); ?>px <?php echo esc_attr( $header_image_height ); ?>px;\n\t\t\t\t\twidth: <?php echo esc_attr( $header_image_width ); ?>px;\n\t\t\t\t\theight: <?php echo esc_attr( $header_image_height ); ?>px;\n\t\t\t\t}\n\t\t\t</style>\n\t\t\t<?php\n\n\t\t\tadd_filter(\n\t\t\t\t'login_headerurl',\n\t\t\t\tstatic function () {\n\t\t\t\t\treturn home_url( '/' );\n\t\t\t\t}\n\t\t\t);\n\t\t\tadd_filter(\n\t\t\t\t'login_headertext',\n\t\t\t\tstatic function () {\n\t\t\t\t\treturn get_bloginfo( 'name', 'display' );\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n);\n"
    }
];
    return steps;
}
customSteps.addLoginBranding.felixArntzMuPlugins = true;
customSteps.addLoginBranding.info = "Adds site specific branding to the login page.";
